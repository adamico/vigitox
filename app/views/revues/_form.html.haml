- resource.build_editorial unless resource.editorial
- resource.redactionships.build if resource.redactionships.empty?

= simple_form_for resource, html: {class: "form-horizontal"} do |f|
  = f.error_notification if f.error_notification
  .control-group
    = f.label :numero, "Numéro", class: "control-label"
    .controls
      = f.number_field :numero, class: "span1", "data-value" => assigned_numero
      Sortie :
      = f.date_select :date_sortie, {:discard_day => true, :include_blank => true, autofocus: true}, {class: "span2"}
  = f.input :pdf_url, label: 'Lien PDF', input_html: {class: "span8"}

  %h4 Editorial
  = f.fields_for :editorial do |editorial_form|
    = editorial_form.input :titre, as: :text, input_html: {class: "span8", rows: 2}
    = editorial_form.input :contenu, as: :ckeditor
    = editorial_form.input :author_name, label: "Autheur", as: :autocomplete, url: autocomplete_author_nom_articles_path

  = f.input :redactionship_tokens, as: :text, label: "Comité rédaction", input_html: {"data-pre" => resource.redacteurs.map(&:attributes).to_json}

  .form-actions
    .btn-group
      = button_tag "Enregistrer", type: :submit, class: "btn btn-success", disable_with: "Enregistrer"
      = link_to "Retour à la liste", revues_path, class: "btn btn-danger"
