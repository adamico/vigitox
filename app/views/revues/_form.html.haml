= content_for :head do
  %script{type: "text/javascript", src: "/javascripts/wymeditor/jquery.wymeditor.min.js"}

- revue.build_editorial unless revue.editorial
- revue.redactionships.build if revue.redactionships.empty?

= simple_form_for revue, html: {class: "form-horizontal"} do |f|
  = f.error_notification if f.error_notification
  .control-group
    = f.label       :numero, "Numéro", class: "control-label"
    .controls
      = f.number_field :numero, class: "span1", value: assigned_numero
      Sortie :
      = f.date_select :date_sortie, {:discard_day => true, :include_blank => true}, {class: "span2"}
  = f.input :pdf_url, label: 'Lien PDF', input_html: {class: "span8"}

  %h4 Editorial
  = f.fields_for :editorial do |editorial_form|
    = editorial_form.input :titre, as: :text, input_html: {class: "span8", rows: 2}
    = editorial_form.input :contenu, as: :text, input_html: {class: "span8 wymeditor", rows: 10}
    = editorial_form.input :author_name, label: "Autheur", as: :autocomplete, url: autocomplete_author_nom_articles_path

  = f.input :redactionship_tokens, as: :text, label: "Comité rédaction", input_html: {"data-pre" => revue.redacteurs.map(&:attributes).to_json}

  .actions
    = f.button :submit, "Enregistrer", class: "btn-success", disable_with: "Enregistrer"
    = link_to "Retour à la liste", revues_path, class: "btn btn-danger"

:coffeescript
  $(".wymeditor").wymeditor
    lang: "fr"
  $('input[type=submit]').addClass('wymupdate')
